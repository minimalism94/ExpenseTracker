<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>Monthly Financial Report</title>
    <style>
        @page {
            margin: 0.5cm;
            size: A4;
        }

        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }

        body {
            font-family: 'Segoe UI', Arial, sans-serif;
            background: linear-gradient(135deg, #1a1a1a 0%, #1f1f2e 50%, #1a1a1a 100%);
            color: #fff;
            padding: 30px;
            line-height: 1.6;
        }

        .header {
            text-align: center;
            margin-bottom: 30px;
            padding-bottom: 20px;
            border-bottom: 3px solid #00ff88;
        }

        .header h1 {
            color: #00ff88;
            font-size: 32px;
            font-weight: 700;
            margin-bottom: 10px;
            text-shadow: 0 0 20px rgba(0, 255, 136, 0.3);
            letter-spacing: 1px;
        }

        .header .month {
            color: #888;
            font-size: 18px;
            text-transform: uppercase;
            letter-spacing: 2px;
        }

        .header .date {
            color: #aaa;
            font-size: 14px;
            margin-top: 5px;
        }

        /* Top Section: Current Balance + Summary */
        .top-section {
            display: table;
            width: 100%;
            margin-bottom: 25px;
        }

        .current-balance-block {
            display: table-cell;
            width: 30%;
            vertical-align: top;
            background: linear-gradient(145deg, #252525 0%, #2a2a2a 100%);
            border: 2px solid rgba(0, 255, 136, 0.3);
            padding: 25px;
            text-align: center;
            border-radius: 15px;
            margin-right: 20px;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.4);
        }

        .current-balance-block h2 {
            font-size: 14px;
            color: #888;
            margin-bottom: 15px;
            font-weight: 500;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .balance-value {
            font-size: 42px;
            font-weight: 700;
            color: #00ff88;
            text-shadow: 0 0 15px rgba(0, 255, 136, 0.4);
        }

        .summary-block {
            display: table-cell;
            width: 70%;
            vertical-align: top;
            padding-left: 20px;
        }

        .summary-grid {
            display: table;
            width: 100%;
            border-spacing: 15px;
        }

        .summary-card {
            display: table-cell;
            width: 50%;
            background: linear-gradient(145deg, #252525 0%, #2a2a2a 100%);
            border: 2px solid rgba(0, 255, 136, 0.2);
            padding: 20px;
            text-align: center;
            border-radius: 12px;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.3);
            vertical-align: top;
        }

        .summary-card h3 {
            font-size: 12px;
            color: #888;
            margin-bottom: 12px;
            font-weight: 500;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .summary-card .value {
            font-size: 28px;
            margin-top: 8px;
            color: #fff;
            font-weight: 700;
            text-shadow: 0 0 10px rgba(255, 255, 255, 0.2);
        }

        .summary-card .value.green {
            color: #00ff88 !important;
            text-shadow: 0 0 15px rgba(0, 255, 136, 0.4);
        }

        .summary-card .value.red {
            color: #ff4757 !important;
            text-shadow: 0 0 15px rgba(255, 71, 87, 0.4);
        }

        .expense-name {
            font-size: 12px;
            color: #fff;
            margin-top: 8px;
            font-weight: 500;
        }

        /* Section Titles */
        .section-title {
            font-size: 20px;
            margin: 30px 0 15px 0;
            color: #00ff88;
            text-align: center;
            text-shadow: 0 0 15px rgba(0, 255, 136, 0.3);
            font-weight: 600;
            letter-spacing: 0.5px;
            padding-bottom: 10px;
            border-bottom: 2px solid rgba(0, 255, 136, 0.3);
        }

        /* Transactions Table */
        .transactions-block {
            background: linear-gradient(145deg, #252525 0%, #2a2a2a 100%);
            border: 2px solid rgba(0, 255, 136, 0.2);
            padding: 20px;
            border-radius: 15px;
            margin-bottom: 25px;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.4);
        }

        .transaction-table {
            width: 100%;
            border-collapse: separate;
            border-spacing: 0;
        }

        .transaction-table thead {
            background: linear-gradient(145deg, #2f2f2f, #2a2a2a);
        }

        .transaction-table th {
            color: #00ff88;
            padding: 12px 10px;
            text-align: left;
            font-weight: 600;
            text-transform: uppercase;
            font-size: 11px;
            letter-spacing: 0.5px;
            text-shadow: 0 0 10px rgba(0, 255, 136, 0.3);
            border-bottom: 2px solid rgba(0, 255, 136, 0.3);
        }

        .transaction-table tbody tr {
            background: linear-gradient(145deg, #1f1f1f 0%, #252525 100%);
            border-bottom: 1px solid rgba(255, 255, 255, 0.05);
        }

        .transaction-table tbody tr:nth-child(even) {
            background: linear-gradient(145deg, #252525 0%, #2a2a2a 100%);
        }

        .transaction-table td {
            padding: 12px 10px;
            color: #eee;
            font-size: 12px;
            border-bottom: 1px solid rgba(255, 255, 255, 0.05);
        }

        .transaction-table td.green {
            color: #00ff88;
            font-weight: 600;
            text-shadow: 0 0 10px rgba(0, 255, 136, 0.3);
        }

        .transaction-table td.red {
            color: #ff4757;
            font-weight: 600;
            text-shadow: 0 0 10px rgba(255, 71, 87, 0.3);
        }

        /* Subscriptions Block */
        .subscriptions-block {
            background: linear-gradient(145deg, #252525 0%, #2a2a2a 100%);
            border: 2px solid rgba(0, 255, 136, 0.2);
            padding: 20px;
            border-radius: 15px;
            margin-bottom: 25px;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.4);
        }

        .subscription-item {
            display: table;
            width: 100%;
            padding: 15px;
            margin-bottom: 12px;
            background: linear-gradient(145deg, #1f1f1f 0%, #252525 100%);
            border: 1px solid rgba(0, 255, 136, 0.15);
            border-radius: 10px;
        }

        .subscription-info {
            display: table-cell;
            vertical-align: middle;
        }

        .subscription-info h4 {
            margin: 0 0 5px 0;
            color: #fff;
            font-size: 15px;
            font-weight: 600;
        }

        .subscription-date {
            margin: 0;
            color: #888;
            font-size: 11px;
        }

        .subscription-price {
            display: table-cell;
            vertical-align: middle;
            text-align: right;
            color: #00ff88;
            font-size: 18px;
            font-weight: 700;
        }

        .no-data {
            text-align: center;
            color: #888;
            padding: 30px;
            font-size: 14px;
        }

        /* Category Table */
        .category-block {
            background: linear-gradient(145deg, #252525 0%, #2a2a2a 100%);
            border: 2px solid rgba(0, 255, 136, 0.2);
            padding: 20px;
            border-radius: 15px;
            margin-bottom: 25px;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.4);
        }

        .category-table {
            width: 100%;
            border-collapse: separate;
            border-spacing: 0;
        }

        .category-table thead {
            background: linear-gradient(145deg, #2f2f2f, #2a2a2a);
        }

        .category-table th {
            color: #00ff88;
            padding: 12px 10px;
            text-align: left;
            font-weight: 600;
            text-transform: uppercase;
            font-size: 11px;
            letter-spacing: 0.5px;
            text-shadow: 0 0 10px rgba(0, 255, 136, 0.3);
            border-bottom: 2px solid rgba(0, 255, 136, 0.3);
        }

        .category-table tbody tr {
            background: linear-gradient(145deg, #1f1f1f 0%, #252525 100%);
            border-bottom: 1px solid rgba(255, 255, 255, 0.05);
        }

        .category-table tbody tr:nth-child(even) {
            background: linear-gradient(145deg, #252525 0%, #2a2a2a 100%);
        }

        .category-table td {
            padding: 12px 10px;
            color: #eee;
            font-size: 12px;
            border-bottom: 1px solid rgba(255, 255, 255, 0.05);
        }

        .category-table td:last-child {
            color: #00ff88;
            font-weight: 600;
        }

        /* Footer */
        .footer {
            margin-top: 40px;
            padding-top: 20px;
            border-top: 2px solid rgba(0, 255, 136, 0.2);
            text-align: center;
            color: #888;
            font-size: 11px;
        }

        .footer p {
            margin: 5px 0;
        }

        .footer .brand {
            color: #00ff88;
            font-weight: 600;
            font-size: 12px;
        }
    </style>
</head>
<body>
<div class="header">
    <h1>Monthly Financial Report</h1>
    <div class="month" th:text="${month}">January 2025</div>
    <div class="date" th:text="${#temporals.format(currentDate, 'dd MMMM yyyy')}">18 November 2025</div>
</div>

<!-- Top Section: Current Balance + Summary -->
<div class="top-section">
    <div class="current-balance-block">
        <h2>Current Balance</h2>
        <p class="balance-value" th:text="'BGN ' + ${wallet.getBalance()}">0.00</p>
    </div>

    <div class="summary-block">
        <div class="summary-grid">
            <div class="summary-card">
                <h3>Total Spent This Month</h3>
                <p class="value red" th:text="'BGN ' + ${currentMonthExpenses}">0.00</p>
            </div>
            <div class="summary-card">
                <h3>Total Income This Month</h3>
                <p class="value green" th:text="'BGN ' + ${currentMonthIncome}">0.00</p>
            </div>
            <div class="summary-card">
                <h3>Net Balance</h3>
                <p class="value" th:text="'BGN ' + ${wallet.getBalance()}">0.00</p>
            </div>
            <div class="summary-card" th:if="${biggestExpense != null}">
                <h3>Biggest Expense</h3>
                <p class="value red" th:text="'BGN ' + ${biggestExpense.amount}">0.00</p>
                <p class="expense-name" th:if="${biggestExpenseName != null}" th:text="${biggestExpenseName}">
                    Category</p>
            </div>
        </div>
    </div>
</div>

<!-- All Transactions -->
<h2 class="section-title">All Transactions</h2>
<div class="transactions-block">
    <table class="transaction-table">
        <thead>
        <tr>
            <th>Date</th>
            <th>Category</th>
            <th>Description</th>
            <th>Type</th>
            <th>Amount</th>
        </tr>
        </thead>
        <tbody>
        <tr th:each="transaction : ${allTransactions}">
            <td th:text="${#temporals.format(transaction.date, 'dd.MM.yyyy HH:mm')}">01.01.2025 12:00</td>
            <td th:text="${#strings.capitalize(transaction.category.name().toLowerCase())}">Category</td>
            <td th:text="${transaction.description}">Description</td>
            <td th:text="${#strings.capitalize(transaction.type.name().toLowerCase())}">Type</td>
            <td th:class="${transaction.type.name() == 'INCOME' ? 'green' : 'red'}"
                th:text="${transaction.type.name() == 'INCOME' ? 'BGN ' : '-BGN '} + ${transaction.amount}">
                -0.00
            </td>
        </tr>
        </tbody>
    </table>
</div>

<!-- Paid Subscriptions -->
<h2 class="section-title">Paid Subscriptions</h2>
<div class="subscriptions-block">
    <div class="no-data" th:if="${paidSubscriptions.isEmpty()}">
        No paid subscriptions this month
    </div>
    <div class="subscription-item" th:each="subscription : ${paidSubscriptions}">
        <div class="subscription-info">
            <h4 th:text="${subscription.name}">Subscription Name</h4>
            <p class="subscription-date" th:text="${#temporals.format(subscription.paidDate, 'dd.MM.yyyy')}">
                01.01.2025</p>
        </div>
        <div class="subscription-price" th:text="'BGN ' + ${subscription.price}">0.00</div>
    </div>
</div>

<!-- Expenses by Category -->
<h2 class="section-title">Expenses by Category</h2>
<div class="category-block">
    <table class="category-table">
        <thead>
        <tr>
            <th>Category</th>
            <th>Amount</th>
            <th>Percentage</th>
        </tr>
        </thead>
        <tbody>
        <tr th:each="categoryName, iterStat : ${categoryNames}">
            <td th:text="${categoryName}">Category</td>
            <td th:text="'BGN ' + ${categoryAmounts[iterStat.index]}">0.00</td>
            <td th:text="${categoryPercents[iterStat.index]} + '%'">0%</td>
        </tr>
        </tbody>
    </table>
</div>

<div class="footer">
    <p class="brand">SmartExpense</p>
    <p>Generated on <span th:text="${#temporals.format(currentDate, 'dd MMMM yyyy')}">18 November 2025</span></p>
    <p>Report for user: <span th:text="${user.username}">username</span></p>
</div>
</body>
</html>
